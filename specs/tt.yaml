---
# This specification creates tables that correspond to each Prolog predicate:

# constantes - For storing lecc_por_sem and lecc_por_dia
# grupos - For the grupo/2 predicate
# aulas - For the aula/2 predicate
# profesores - For the prof/2 predicate
# grupo_materias - For grupo_materia_lecciones/4
# prof_grupo_materias - For prof_grupo_materia/3
# dias, bloques, lecciones - For the basic facts used in dia_bloque_leccion/3
# disponibilidad_profesores - For disp_prof_dia_bloque_leccion/4

DatabaseSpec:
  tables:
    - name: constantes
      columns:
        - name: name
          type: string
          not_null: true
        - name: value
          type: integer
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [name]

    - name: grupos
      columns:
        - name: id
          type: integer
          not_null: true
        - name: nombre
          type: string
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [id]
        - type: UNIQUE
          columns: [nombre]

    - name: materias
      columns:
        - name: id
          type: integer
          not_null: true
        - name: nombre
          type: string
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [id]
        - type: UNIQUE
          columns: [nombre]

    # - name: aulas
    #   columns:
    #     - name: id
    #       type: integer
    #       not_null: true
    #     - name: nombre
    #       type: string
    #       not_null: true
    #   constraints:
    #     - type: PRIMARY KEY
    #       columns: [id]
    #     - type: UNIQUE
    #       columns: [nombre]

    - name: profesores
      columns:
        - name: id
          type: integer
          not_null: true
        - name: nombre
          type: string
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [id]
        - type: UNIQUE
          columns: [nombre]

    - name: grupo_materias
      columns:
        - name: id
          type: integer
          not_null: true
        - name: grupo_id
          type: integer
          not_null: true
        - name: materia_id
          type: integer
          not_null: true
        - name: lecciones
          type: integer
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [id]
        - type: UNIQUE
          columns: [grupo_id, materia_id]
        - type: FOREIGN KEY
          columns: [ grupo_id ]
          references:
            table: grupos
            columns: [ id ]
        - type: FOREIGN KEY
          columns: [materia_id]
          references:
            table: materias
            columns: [id]

    - name: prof_grupo_materias
      columns:
        - name: profesor_id
          type: integer
          not_null: true
        - name: grupo_id
          type: integer
          not_null: true
        - name: materia_id
          type: integer
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [profesor_id, grupo_id, materia_id]
        - type: FOREIGN KEY
          columns: [ profesor_id ]
          references:
            table: profesores
            columns: [ id ]
        - type: FOREIGN KEY
          columns: [ grupo_id ]
          references:
            table: grupos
            columns: [ id ]
        - type: FOREIGN KEY
          columns: [materia_id]
          references:
            table: materias
            columns: [ id ]

    - name: dias
      columns:
        - name: id
          type: integer
          not_null: true
        - name: nombre
          type: string
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [id]

    - name: bloques
      columns:
        - name: id
          type: integer
          not_null: true
        - name: nombre
          type: integer
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [id]

    - name: lecciones
      columns:
        - name: id
          type: integer
          not_null: true
        - name: nombre
          type: string
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [id]

    - name: disponibilidad_profesores
      columns:
        - name: profesor_id
          type: integer
          not_null: true
        - name: dia_id
          type: integer
          not_null: true
        - name: bloque_id
          type: integer
          not_null: true
        - name: leccion_id
          type: integer
          not_null: true
      constraints:
        - type: PRIMARY KEY
          columns: [profesor_id, dia_id, bloque_id, leccion_id]
        - type: FOREIGN KEY
          columns: [ profesor_id ]
          references:
            table: profesores
            columns: [ id ]
        - type: FOREIGN KEY
          columns: [ dia_id ]
          references:
            table: dias
            columns: [ id ]
        - type: FOREIGN KEY
          columns: [ bloque_id ]
          references:
            table: bloques
            columns: [ id ]
        - type: FOREIGN KEY
          columns: [ leccion_id ]
          references:
            table: lecciones
            columns: [ id ]
